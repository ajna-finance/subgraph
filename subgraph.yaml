specVersion: 0.0.5
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum
    name: PositionManager
    network: goerli
    source:
      address: "0x235162AF9407e485DeB9E2f65CDC621B087B540C"
      abi: PositionManager
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Approval
        - ApprovalForAll
        - Burn
        - MemorializePosition
        - Mint
        - MoveLiquidity
        - RedeemPosition
        - Transfer
      abis:
        - name: PositionManager
          file: ./abis/PositionManager.json
      eventHandlers:
        - event: Approval(indexed address,indexed address,indexed uint256)
          handler: handleApproval
        - event: ApprovalForAll(indexed address,indexed address,bool)
          handler: handleApprovalForAll
        - event: Burn(indexed address,indexed uint256)
          handler: handleBurn
        - event: MemorializePosition(indexed address,uint256)
          handler: handleMemorializePosition
        - event: Mint(indexed address,indexed address,uint256)
          handler: handleMint
        - event: MoveLiquidity(indexed address,uint256)
          handler: handleMoveLiquidity
        - event: RedeemPosition(indexed address,uint256)
          handler: handleRedeemPosition
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
      file: ./src/position-manager.ts
  - kind: ethereum
    name: ERC20PoolFactory
    network: goerli
    source:
      address: "0xbF332da94B818AC7972484997100c8cBB400b991"
      abi: ERC20PoolFactory
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - PoolCreated
      abis:
        - name: ERC20PoolFactory
          file: ./abis/ERC20PoolFactory.json
          # add token ABI to each respective factory type for querying token contracts
        - name: ERC20
          file: ./abis/ERC20.json
      eventHandlers:
        - event: PoolCreated(address)
          handler: handlePoolCreated
      file: ./src/erc-20-pool-factory.ts
  - kind: ethereum
    name: RewardsManager
    network: goerli
    source:
      address: "0x6757ccD59eCD0088f01c5F2d4992258CB12cC376"
      abi: RewardsManager
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - ClaimRewards
        - Stake
        - Unstake
        - UpdateExchangeRates
      abis:
        - name: RewardsManager
          file: ./abis/RewardsManager.json
      eventHandlers:
        - event: ClaimRewards(indexed address,indexed address,indexed uint256,uint256[],uint256)
          handler: handleClaimRewards
        - event: Stake(indexed address,indexed address,indexed uint256)
          handler: handleStake
        - event: Unstake(indexed address,indexed address,indexed uint256)
          handler: handleUnstake
        - event: UpdateExchangeRates(indexed address,indexed address,uint256[],uint256)
          handler: handleUpdateExchangeRates
      file: ./src/rewards-manager.ts
  - kind: ethereum
    name: ERC721PoolFactory
    network: goerli
    source:
      address: "0x0bBd35022094a75b5A58A2E6Fa6F1989A0F682F5"
      abi: ERC721PoolFactory
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - ERC721PoolFactoryPoolCreated
      abis:
        - name: ERC721PoolFactory
          file: ./abis/ERC721PoolFactory.json
        - name: ERC20
          file: ./abis/ERC20.json          
      eventHandlers:
        - event: ERC721PoolFactoryPoolCreated(address)
          handler: handleERC721PoolFactoryPoolCreated
      file: ./src/erc-721-pool-factory.ts
templates:
  - kind: ethereum
    name: ERC20Pool
    network: goerli
    source:
      abi: ERC20Pool
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - AddCollateral
        - AddQuoteToken
        - AuctionNFTSettle
        - AuctionSettle
        - BucketBankruptcy
        - BucketTake
        - BucketTakeLPAwarded
        - DrawDebt
        - Kick
        - MoveQuoteToken
        - RemoveCollateral
        - RemoveQuoteToken
        - RepayDebt
        - ReserveAuction
        - Settle
        - Take
        - TransferLPTokens
        - UpdateInterestRate
      abis:
        - name: ERC20Pool
          file: ./abis/ERC20Pool.json
        - name: PoolInfoUtils
          file: ./abis/PoolInfoUtils.json
      eventHandlers:
        - event: AddCollateral(indexed address,indexed uint256,uint256,uint256)
          handler: handleAddCollateral
        - event: AddQuoteToken(indexed address,indexed uint256,uint256,uint256,uint256)
          handler: handleAddQuoteToken
        - event: AuctionNFTSettle(indexed address,uint256,uint256,uint256)
          handler: handleAuctionNFTSettle
        - event: AuctionSettle(indexed address,uint256)
          handler: handleAuctionSettle
        - event: BucketBankruptcy(indexed uint256,uint256)
          handler: handleBucketBankruptcy
        - event: BucketTake(indexed address,uint256,uint256,uint256,uint256,bool)
          handler: handleBucketTake
        - event: BucketTakeLPAwarded(indexed address,indexed address,uint256,uint256)
          handler: handleBucketTakeLPAwarded
        - event: DrawDebt(indexed address,uint256,uint256,uint256)
          handler: handleDrawDebt
        - event: Kick(indexed address,uint256,uint256,uint256)
          handler: handleKick
        - event: MoveQuoteToken(indexed address,indexed uint256,indexed
            uint256,uint256,uint256,uint256,uint256)
          handler: handleMoveQuoteToken
        - event: RemoveCollateral(indexed address,indexed uint256,uint256,uint256)
          handler: handleRemoveCollateral
        - event: RemoveQuoteToken(indexed address,indexed uint256,uint256,uint256,uint256)
          handler: handleRemoveQuoteToken
        - event: RepayDebt(indexed address,uint256,uint256,uint256)
          handler: handleRepayDebt
        - event: ReserveAuction(uint256,uint256)
          handler: handleReserveAuction
        - event: Settle(indexed address,uint256)
          handler: handleSettle
        - event: Take(indexed address,uint256,uint256,uint256,bool)
          handler: handleTake
        - event: TransferLPTokens(address,address,uint256[],uint256)
          handler: handleTransferLPTokens
        - event: UpdateInterestRate(uint256,uint256)
          handler: handleUpdateInterestRate
      file: ./src/erc-20-pool.ts